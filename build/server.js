(()=>{"use strict";var e,t,r,n,o,i,s,a,u={961:(e,t,r)=>{t.__esModule=!0,t.logger=void 0;var n=r(944),o=[new n.transports.File({level:"info",filename:"logs/winston/errors.log",maxsize:3e7,tailable:!0,maxFiles:3}),new n.transports.Console({format:n.format.simple()})],i=[new n.transports.File({level:"info",filename:"logs/winston/info.log",maxsize:3e7,tailable:!0,maxFiles:3}),new n.transports.Console({format:n.format.simple()})],s=n.createLogger({format:n.format.combine(n.format.printf((function(e){return e.message}))),transports:o}),a=n.createLogger({format:n.format.combine(n.format.printf((function(e){return e.message}))),transports:i});t.logger={info:function(e){a.info(e+" | "+(new Date).toISOString())},error:function(e,t){s.error(e.message,{date:(new Date).toLocaleString(),statusCode:e.statusCode||"500",url:t||"",stack:e.stack})}}},509:(e,t)=>{t.__esModule=!0,t.BASE=t.ADMIN=void 0,t.ADMIN="ADMIN",t.BASE="BASE"},145:function(e,t,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.__esModule=!0,t.authorization=t.authentication=void 0;var o=r(722),i=r(839);t.authentication=function(){return function(e,t,r){var s=e.headers.authorization||e.headers["x-access-token"];if(t.locals.authInfo=null,console.log("authentication...",s||"unknow user"),s)try{var a=o.verify(s,"");t.locals.authInfo=n(n({},a),{JWT:s})}catch(e){throw new i.HttpError(e,403)}r()}},t.authorization=function(e){return function(t,r,n){if(!r.locals.authInfo)throw new i.HttpError("User is not authenticated.",401);if(!e.includes(r.locals.authInfo.roleName))throw new i.HttpError("User does not have the right roles.",401);console.log("authorization...",e),n()}}},583:(e,t,r)=>{t.__esModule=!0,t.errorMidLogger=void 0;var n=r(944),o=[new n.transports.File({level:"error",filename:"logs/winston/mid-errors.log",maxsize:3e7,tailable:!0,maxFiles:3})],i=n.createLogger({format:n.format.combine(n.format.timestamp({format:"YYYY-MM-DDTHH:mm:ss:ms"}),n.format.printf((function(e){return JSON.stringify(e)+","}))),transports:o});t.errorMidLogger=function(e,t,r,n){i.error(e.message,{date:(new Date).toLocaleString(),statusCode:e.statusCode||"500",url:t.url||"",stack:e.stack}),r.status(e.statusCode||500).send(e.message||e),n()}},839:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});t.__esModule=!0,t.HttpError=void 0;var o=function(e){function t(t,r){var n=e.call(this,t)||this;return n.statusCode=r||500,n}return n(t,e),t}(Error);t.HttpError=o},333:(e,t,r)=>{t.__esModule=!0,t.router=void 0;var n=r(127).Router();t.router=n,n.get("/",(function(e,t){t.render("home",{page:{header:{title:"header title"},title:"page title",description:"page description",links:[{url:"https://www.google.it",label:"google link",target:"_blank"},{url:"https://www.google.it?p=2",label:"google link2",target:"_blank"}]}})}))},479:(e,t,r)=>{t.__esModule=!0;var n=r(558),o=r(333),i=r(583);t.default=function(e){e.use("/api/users",n.router),e.use("/",o.router),e.use(i.errorMidLogger)}},558:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};t.__esModule=!0,t.router=void 0;var i=r(127),s=r(961),a=r(509),u=r(145),c=r(55),l=r(115),f=r(839),d=i.Router();t.router=d,d.get("/",u.authentication(),u.authorization([a.ADMIN,a.BASE]),(function(e,t){return n(void 0,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return s.logger.info("You get all users!"),[4,c.UsersService.getUsers()];case 1:return e=r.sent(),t.send(e),[2]}}))}))})),d.get("/:id",u.authentication(),u.authorization([a.ADMIN,a.BASE]),(function(e,t){return n(void 0,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return[4,c.UsersService.getUser(e.params.id)];case 1:if(!(r=n.sent()))throw new f.HttpError("The user not found.",404);return t.send(r),[2]}}))}))})),d.post("/",u.authentication(),u.authorization([a.ADMIN]),(function(e,t){return n(void 0,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:if(r=l.validateCreateUser(e.body).error)throw new f.HttpError(r.details[0].message,400);return[4,c.UsersService.createUser(e.body)];case 1:return n=o.sent(),t.send(n),[2]}}))}))})),d.put("/:id",u.authentication(),u.authorization([a.ADMIN]),(function(e,t){return n(void 0,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:if(r=l.validateEditUser(e.body).error)throw new f.HttpError(r.details[0].message,400);if(e.body._id!==e.params.id)throw new f.HttpError("The body _id does not match with URL ID",400);return[4,c.UsersService.getUser(e.params.id)];case 1:if(!o.sent())throw new f.HttpError("The user not found.",404);return[4,c.UsersService.updateUser(e.params.id,e.body)];case 2:return o.sent().ok?[4,c.UsersService.getUser(e.params.id)]:[3,4];case 3:n=o.sent(),o.label=4;case 4:return t.send(n),[2]}}))}))})),d.delete("/:id",u.authentication(),u.authorization([a.ADMIN]),(function(e,t){return n(void 0,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return[4,c.UsersService.getUser(e.params.id)];case 1:if(!n.sent())throw new f.HttpError("The user not found.",404);return[4,c.UsersService.deleteUser(e.params.id)];case 2:return r=n.sent(),t.send(r),[2]}}))}))}))},55:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};t.__esModule=!0,t.UsersService=void 0;var i=r(905),s=function(){function e(){}return e.getUsers=function(){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,i.User.find().limit(10)];case 1:return[2,e.sent()]}}))}))},e.getUser=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,i.User.findOne({_id:e})];case 1:return[2,t.sent()]}}))}))},e.createUser=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return e.creationDate=Date.now(),[4,new i.User(e).save()];case 1:return[2,t.sent()]}}))}))},e.updateUser=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return t.modificationDate=Date.now(),[4,i.User.updateOne({_id:e},t)];case 1:return[2,r.sent()]}}))}))},e.deleteUser=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,i.User.deleteOne({_id:e})];case 1:return[2,t.sent()]}}))}))},e}();t.UsersService=s},905:(e,t,r)=>{t.__esModule=!0,t.User=void 0;var n=r(619),o=r(142).get("mongodbConnectionString")||"mongodb://localhost/";console.log(o);var i=n.connection;i.on("connecting",(function(){console.log("connecting to MongoDB...")})),i.on("error",(function(e){console.log("Error in MongoDb connection: "+e)})),i.on("connected",(function(){console.log("MongoDB connected!")})),i.once("open",(function(){console.log("MongoDB connection opened!")})),i.on("reconnected",(function(){console.log("MongoDB reconnected!")})),i.on("disconnected",(function(){console.log("MongoDB disconnected!")})),n.connect(o+"AuthProvider",{useUnifiedTopology:!0,useNewUrlParser:!0});var s=new n.Schema({firstName:String,lastName:String,email:String,isActive:Boolean,modificationDate:{type:Date,default:null},creationDate:{type:Date}});t.User=n.model("User",s,"users")},115:(e,t,r)=>{t.__esModule=!0,t.validateEditUser=t.validateCreateUser=void 0;var n=r(320);t.validateCreateUser=function(e){return n.object({firstName:n.string().min(3).required(),lastName:n.string().min(3).required(),email:n.string().email({minDomainSegments:2}).required(),isActive:n.bool()}).validate(e)},t.validateEditUser=function(e){return n.object({_id:n.string().length(24).required(),firstName:n.string().min(3).required(),lastName:n.string().min(3).required(),email:n.string().email({minDomainSegments:2}).required(),isActive:n.bool()}).validate(e)}},142:e=>{e.exports=require("config")},127:e=>{e.exports=require("express")},725:e=>{e.exports=require("helmet")},320:e=>{e.exports=require("joi")},722:e=>{e.exports=require("jsonwebtoken")},619:e=>{e.exports=require("mongoose")},150:e=>{e.exports=require("morgan")},622:e=>{e.exports=require("path")},944:e=>{e.exports=require("winston")}},c={};function l(e){if(c[e])return c[e].exports;var t=c[e]={exports:{}};return u[e].call(t.exports,t,t.exports,l),t.exports}e=l(142),t=l(127),r=l(622),n=l(479),o=l(150),i=l(725),s=e.get("port")||3e3,(a=t()).use(t.json()),a.use(t.urlencoded({extended:!0})),a.set("views",r.join(__dirname,"views")),a.set("view engine","ejs"),e.get("enableAccessLogs")&&a.use(o("tiny")),a.use(i()),a.use(t.static("public")),n.default(a),a.listen(s,(function(){console.log("server started at http://localhost:"+s)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ub2RlanMtc3RhcnRlci8uL3NyYy9zZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvLi9zcmMvY29yZS9sb2dnZXIudHMiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvLi9zcmMvY29yZS9yb2xlcy50cyIsIndlYnBhY2s6Ly9ub2RlanMtc3RhcnRlci8uL3NyYy9taWRkbGV3YXJlL2F1dGhQcm92aWRlci50cyIsIndlYnBhY2s6Ly9ub2RlanMtc3RhcnRlci8uL3NyYy9taWRkbGV3YXJlL21pZEVycm9ycy50cyIsIndlYnBhY2s6Ly9ub2RlanMtc3RhcnRlci8uL3NyYy9tb2RlbHMvZXJyb3JzLnRzIiwid2VicGFjazovL25vZGVqcy1zdGFydGVyLy4vc3JjL3JvdXRlcy9ob21lLnRzIiwid2VicGFjazovL25vZGVqcy1zdGFydGVyLy4vc3JjL3JvdXRlcy9pbmRleC50cyIsIndlYnBhY2s6Ly9ub2RlanMtc3RhcnRlci8uL3NyYy9yb3V0ZXMvdXNlcnMudHMiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvLi9zcmMvc2VydmljZXMvdXNlcnNTZXJ2aWNlLnRzIiwid2VicGFjazovL25vZGVqcy1zdGFydGVyLy4vc3JjL3N0b3JlL2RiQ29udGV4dC50cyIsIndlYnBhY2s6Ly9ub2RlanMtc3RhcnRlci8uL3NyYy9zdG9yZS92YWxpZGF0b3JzLnRzIiwid2VicGFjazovL25vZGVqcy1zdGFydGVyL2V4dGVybmFsIFwiY29uZmlnXCIiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvZXh0ZXJuYWwgXCJleHByZXNzXCIiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvZXh0ZXJuYWwgXCJoZWxtZXRcIiIsIndlYnBhY2s6Ly9ub2RlanMtc3RhcnRlci9leHRlcm5hbCBcImpvaVwiIiwid2VicGFjazovL25vZGVqcy1zdGFydGVyL2V4dGVybmFsIFwianNvbndlYnRva2VuXCIiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvZXh0ZXJuYWwgXCJtb25nb29zZVwiIiwid2VicGFjazovL25vZGVqcy1zdGFydGVyL2V4dGVybmFsIFwibW9yZ2FuXCIiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvZXh0ZXJuYWwgXCJwYXRoXCIiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvZXh0ZXJuYWwgXCJ3aW5zdG9uXCIiLCJ3ZWJwYWNrOi8vbm9kZWpzLXN0YXJ0ZXIvd2VicGFjay9ib290c3RyYXAiXSwibmFtZXMiOlsiUE9SVCIsImFwcCIsInRyYW5zcG9ydEVycm9yIiwidHJhbnNwb3J0cyIsIkZpbGUiLCJsZXZlbCIsImZpbGVuYW1lIiwibWF4c2l6ZSIsInRhaWxhYmxlIiwibWF4RmlsZXMiLCJDb25zb2xlIiwiZm9ybWF0Iiwic2ltcGxlIiwidHJhbnNwb3J0SW5mbyIsImxvZ2dlckVycm9yIiwiY3JlYXRlTG9nZ2VyIiwiY29tYmluZSIsInByaW50ZiIsImVyciIsIm1lc3NhZ2UiLCJsb2dnZXJJbmZvIiwiaW5mbyIsImxvZ2dlciIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImVycm9yIiwidXJsIiwiZGF0ZSIsInRvTG9jYWxlU3RyaW5nIiwic3RhdHVzQ29kZSIsInN0YWNrIiwiQURNSU4iLCJCQVNFIiwiYXV0aGVudGljYXRpb24iLCJyZXEiLCJyZXMiLCJuZXh0IiwidG9rZW4iLCJoZWFkZXJzIiwibG9jYWxzIiwiYXV0aEluZm8iLCJjb25zb2xlIiwibG9nIiwiZGVjb2RlZCIsImp3dCIsInZlcmlmeSIsIkpXVCIsIkh0dHBFcnJvciIsImF1dGhvcml6YXRpb24iLCJyb3V0ZVZhbGlkUm9sZXMiLCJpbmNsdWRlcyIsInJvbGVOYW1lIiwidHJhbnNwb3J0RXJyb3JzIiwidGltZXN0YW1wIiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yTWlkTG9nZ2VyIiwic3RhdHVzIiwic2VuZCIsIkVycm9yIiwicm91dGVyIiwiUm91dGVyIiwiZ2V0IiwicmVuZGVyIiwicGFnZSIsImhlYWRlciIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJsaW5rcyIsImxhYmVsIiwidGFyZ2V0IiwidXNlIiwiZ2V0VXNlcnMiLCJyZXN1bHQiLCJnZXRVc2VyIiwicGFyYW1zIiwiaWQiLCJwb3N0IiwidmFsaWRhdGVDcmVhdGVVc2VyIiwiYm9keSIsImRldGFpbHMiLCJjcmVhdGVVc2VyIiwicHV0IiwidmFsaWRhdGVFZGl0VXNlciIsIl9pZCIsInVwZGF0ZVVzZXIiLCJvayIsInVzZXIiLCJkZWxldGVVc2VyIiwicmVzcG9uc2VEZWxldGUiLCJkYkNvbnRleHQiLCJVc2VyIiwiZmluZCIsImxpbWl0IiwiZmluZE9uZSIsImNyZWF0aW9uRGF0ZSIsIm5vdyIsInNhdmUiLCJtb2RpZmljYXRpb25EYXRlIiwidXBkYXRlT25lIiwiZGVsZXRlT25lIiwiVXNlcnNTZXJ2aWNlIiwiY29ubmVjdGlvblN0cmluZyIsImRiIiwibW9uZ29vc2UiLCJjb25uZWN0aW9uIiwib24iLCJvbmNlIiwiY29ubmVjdCIsInVzZVVuaWZpZWRUb3BvbG9neSIsInVzZU5ld1VybFBhcnNlciIsInVzZXJTY2hlbWEiLCJTY2hlbWEiLCJmaXJzdE5hbWUiLCJTdHJpbmciLCJsYXN0TmFtZSIsImVtYWlsIiwiaXNBY3RpdmUiLCJCb29sZWFuIiwidHlwZSIsImRlZmF1bHQiLCJtb2RlbCIsIkpvaSIsIm9iamVjdCIsInN0cmluZyIsIm1pbiIsInJlcXVpcmVkIiwibWluRG9tYWluU2VnbWVudHMiLCJib29sIiwidmFsaWRhdGUiLCJsZW5ndGgiLCJtb2R1bGUiLCJleHBvcnRzIiwicmVxdWlyZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJjYWxsIiwiY29uZmlnIiwiZXhwcmVzcyIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJzZXQiLCJwYXRoIiwiam9pbiIsIl9fZGlybmFtZSIsIm1vcmdhbiIsImhlbG1ldCIsInN0YXRpYyIsImxpc3RlbiJdLCJtYXBw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TSxTQUVHQyxTQUFTMUMsSyxRQ3BCbEM0QyxFQUFPQyxRQUFVQyxRQUFRLFcsUUNBekJGLEVBQU9DLFFBQVVDLFFBQVEsWSxRQ0F6QkYsRUFBT0MsUUFBVUMsUUFBUSxXLFFDQXpCRixFQUFPQyxRQUFVQyxRQUFRLFEsUUNBekJGLEVBQU9DLFFBQVVDLFFBQVEsaUIsUUNBekJGLEVBQU9DLFFBQVVDLFFBQVEsYSxRQ0F6QkYsRUFBT0MsUUFBVUMsUUFBUSxXLFFDQXpCRixFQUFPQyxRQUFVQyxRQUFRLFMsUUNBekJGLEVBQU9DLFFBQVVDLFFBQVEsYUNDckJDLEVBQTJCLEdBRy9CLFNBQVNDLEVBQW9CQyxHQUU1QixHQUFHRixFQUF5QkUsR0FDM0IsT0FBT0YsRUFBeUJFLEdBQVVKLFFBRzNDLElBQUlELEVBQVNHLEVBQXlCRSxHQUFZLENBR2pESixRQUFTLElBT1YsT0FIQUssRUFBb0JELEdBQVVFLEtBQUtQLEVBQU9DLFFBQVNELEVBQVFBLEVBQU9DLFFBQVNHLEdBR3BFSixFQUFPQyxRckJwQmYsU0FDQSxTQUNBLFNBQ0EsU0FDQSxTQUNBLFNBR01wSSxFQUFPMkksRUFBTzdFLElBQUksU0FBVyxLQUM3QjdELEVBQU0ySSxLQUVSckUsSUFBSXFFLEVBQVFDLFFBQ2hCNUksRUFBSXNFLElBQUlxRSxFQUFRRSxXQUFXLENBQUVDLFVBQVUsS0FDdkM5SSxFQUFJK0ksSUFBSSxRQUFTQyxFQUFLQyxLQUFLQyxVQUFXLFVBQ3RDbEosRUFBSStJLElBQUksY0FBZSxPQUVuQkwsRUFBTzdFLElBQUkscUJBQ2I3RCxFQUFJc0UsSUFBSTZFLEVBQU8sU0FFakJuSixFQUFJc0UsSUFBSThFLEtBRVJwSixFQUFJc0UsSUFBSXFFLEVBQVFVLE9BQU8sV0FFdkIsVUFBT3JKLEdBRVBBLEVBQUlzSixPQUFPdkosR0FBTSxXQUNmeUMsUUFBUUMsSUFBSSxzQ0FBd0MxQyxPIiwiZmlsZSI6InNlcnZlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNvbmZpZyBmcm9tICdjb25maWcnO1xyXG5pbXBvcnQgKiBhcyBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xyXG5pbXBvcnQgICogYXMgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0IHJvdXRlcyBmcm9tICcuL3JvdXRlcy9pbmRleCc7XHJcbmltcG9ydCAqIGFzIG1vcmdhbiBmcm9tICdtb3JnYW4nO1xyXG5pbXBvcnQgKiBhcyBoZWxtZXQgZnJvbSAnaGVsbWV0JzsgLy8gU2VjdXJpdHlcclxuaW1wb3J0IGMgPSByZXF1aXJlKCdjb25maWcnKTtcclxuXHJcbmNvbnN0IFBPUlQgPSBjb25maWcuZ2V0KCdwb3J0JykgfHwgMzAwMDtcclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5cclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpO1xyXG5hcHAuc2V0KCd2aWV3cycsIHBhdGguam9pbihfX2Rpcm5hbWUsICd2aWV3cycpKTtcclxuYXBwLnNldCgndmlldyBlbmdpbmUnLCAnZWpzJyk7XHJcblxyXG5pZiAoY29uZmlnLmdldCgnZW5hYmxlQWNjZXNzTG9ncycpKSB7XHJcbiAgYXBwLnVzZShtb3JnYW4oJ3RpbnknKSk7XHJcbn1cclxuYXBwLnVzZShoZWxtZXQoKSk7XHJcblxyXG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKCdwdWJsaWMnKSk7XHJcblxyXG5yb3V0ZXMoYXBwKTtcclxuXHJcbmFwcC5saXN0ZW4oUE9SVCwgKCkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKCdzZXJ2ZXIgc3RhcnRlZCBhdCBodHRwOi8vbG9jYWxob3N0OicgKyBQT1JUKTtcclxufSk7XHJcbiIsIi8vIGNvbnN0IHsgY3JlYXRlTG9nZ2VyLCB0cmFuc3BvcnRzLCBmb3JtYXQgfSA9IHJlcXVpcmUoJ3dpbnN0b24nKTtcclxuaW1wb3J0ICB7IGNyZWF0ZUxvZ2dlciwgdHJhbnNwb3J0cywgZm9ybWF0IH0gZnJvbSAnd2luc3Rvbic7XHJcblxyXG5jb25zdCB0cmFuc3BvcnRFcnJvciA9IFtcclxuICAgIG5ldyB0cmFuc3BvcnRzLkZpbGUoe1xyXG4gICAgICAgIGxldmVsOiAnaW5mbycsXHJcbiAgICAgICAgZmlsZW5hbWU6ICdsb2dzL3dpbnN0b24vZXJyb3JzLmxvZycsXHJcbiAgICAgICAgbWF4c2l6ZTogMzAwMDAwMDAsIC8vIDMwTUJcclxuICAgICAgICB0YWlsYWJsZTogdHJ1ZSxcclxuICAgICAgICBtYXhGaWxlczogMyxcclxuICAgIH0pLFxyXG4gICAgbmV3IHRyYW5zcG9ydHMuQ29uc29sZSh7XHJcbiAgICAgICAgZm9ybWF0OiBmb3JtYXQuc2ltcGxlKCksXHJcbiAgICB9KSxcclxuXTtcclxuY29uc3QgdHJhbnNwb3J0SW5mbyA9IFtcclxuICAgIG5ldyB0cmFuc3BvcnRzLkZpbGUoe1xyXG4gICAgICAgIGxldmVsOiAnaW5mbycsXHJcbiAgICAgICAgZmlsZW5hbWU6ICdsb2dzL3dpbnN0b24vaW5mby5sb2cnLFxyXG4gICAgICAgIG1heHNpemU6IDMwMDAwMDAwLCAvLyAzME1CXHJcbiAgICAgICAgdGFpbGFibGU6IHRydWUsXHJcbiAgICAgICAgbWF4RmlsZXM6IDMsXHJcbiAgICB9KSxcclxuICAgIG5ldyB0cmFuc3BvcnRzLkNvbnNvbGUoe1xyXG4gICAgICAgIGZvcm1hdDogZm9ybWF0LnNpbXBsZSgpLFxyXG4gICAgfSksXHJcbl07XHJcbmNvbnN0IGxvZ2dlckVycm9yID0gY3JlYXRlTG9nZ2VyKHtcclxuICAgIGZvcm1hdDogZm9ybWF0LmNvbWJpbmUoXHJcbiAgICAgICAgZm9ybWF0LnByaW50ZihlcnIgPT4gZXJyLm1lc3NhZ2UpLFxyXG4gICAgKSxcclxuICAgIHRyYW5zcG9ydHM6IHRyYW5zcG9ydEVycm9yLFxyXG59KTtcclxuY29uc3QgbG9nZ2VySW5mbyA9IGNyZWF0ZUxvZ2dlcih7XHJcbiAgICBmb3JtYXQ6IGZvcm1hdC5jb21iaW5lKFxyXG4gICAgICAgIGZvcm1hdC5wcmludGYoaW5mbyA9PiBpbmZvLm1lc3NhZ2UpLFxyXG4gICAgKSxcclxuICAgIHRyYW5zcG9ydHM6IHRyYW5zcG9ydEluZm8sXHJcbn0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGxvZ2dlciA9IHtcclxuICAgIGluZm8obWVzc2FnZSkge1xyXG4gICAgICAgIGxvZ2dlckluZm8uaW5mbyhtZXNzYWdlICsgJyB8ICcgKyBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkpO1xyXG4gICAgfSxcclxuICAgIGVycm9yKGVyciwgdXJsKSB7XHJcbiAgICAgICAgbG9nZ2VyRXJyb3IuZXJyb3IoZXJyLm1lc3NhZ2UsIHtcclxuICAgICAgICAgICAgZGF0ZTogbmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpLFxyXG4gICAgICAgICAgICBzdGF0dXNDb2RlOiBlcnIuc3RhdHVzQ29kZSB8fCAnNTAwJyxcclxuICAgICAgICAgICAgdXJsOiB1cmwgfHwgJycsXHJcbiAgICAgICAgICAgIHN0YWNrOiBlcnIuc3RhY2ssXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0ICBBRE1JTj1cIkFETUlOXCI7XHJcbmV4cG9ydCBjb25zdCAgQkFTRT1cIkJBU0VcIjtcclxuXHJcbiIsImltcG9ydCAgKiBhcyBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcclxuaW1wb3J0IHsgSHR0cEVycm9yfSBmcm9tICcuLi9tb2RlbHMvZXJyb3JzJztcclxuZXhwb3J0IGNvbnN0IGF1dGhlbnRpY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gIGNvbnN0IEpXVF9LRVkgPSAnJzsgLy8gaW5zZXJ0IGhlcmUgSldUIGtleTtcclxuXHJcbiAgcmV0dXJuIGZ1bmN0aW9uIGdldFVzZXIocmVxLCByZXMsIG5leHQpIHtcclxuICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnNbJ2F1dGhvcml6YXRpb24nXSB8fCByZXEuaGVhZGVyc1sneC1hY2Nlc3MtdG9rZW4nXTtcclxuXHJcbiAgICByZXMubG9jYWxzLmF1dGhJbmZvID0gbnVsbDtcclxuICAgIGNvbnNvbGUubG9nKCdhdXRoZW50aWNhdGlvbi4uLicsIHRva2VuIHx8ICd1bmtub3cgdXNlcicpO1xyXG5cclxuICAgIGlmICh0b2tlbikge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIEpXVF9LRVkpYXMgb2JqZWN0O1xyXG5cclxuICAgICAgICByZXMubG9jYWxzLmF1dGhJbmZvID0geyAuLi5kZWNvZGVkLCBKV1Q6IHRva2VuIH07XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IoZXJyLCA0MDMpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBuZXh0KCk7XHJcbiAgfTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGF1dGhvcml6YXRpb24gPSBmdW5jdGlvbiAocm91dGVWYWxpZFJvbGVzKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uIGdldEFjY2VzcyhyZXEsIHJlcywgbmV4dCkge1xyXG4gICAgaWYgKCFyZXMubG9jYWxzLmF1dGhJbmZvKSB7XHJcbiAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IoJ1VzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWQuJywgNDAxKTtcclxuICAgIH1cclxuICAgIGlmICghcm91dGVWYWxpZFJvbGVzLmluY2x1ZGVzKHJlcy5sb2NhbHMuYXV0aEluZm8ucm9sZU5hbWUpKSB7XHJcbiAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IoJ1VzZXIgZG9lcyBub3QgaGF2ZSB0aGUgcmlnaHQgcm9sZXMuJywgNDAxKTtcclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKCdhdXRob3JpemF0aW9uLi4uJywgcm91dGVWYWxpZFJvbGVzKTtcclxuICAgIG5leHQoKTtcclxuICB9O1xyXG59O1xyXG5cclxuXHJcbiIsImltcG9ydCB7IGNyZWF0ZUxvZ2dlciwgdHJhbnNwb3J0cywgZm9ybWF0IH0gZnJvbSAnd2luc3Rvbic7XHJcblxyXG5jb25zdCB0cmFuc3BvcnRFcnJvcnMgPSBbXHJcbiAgICBuZXcgdHJhbnNwb3J0cy5GaWxlKHtcclxuICAgICAgICBsZXZlbDogJ2Vycm9yJyxcclxuICAgICAgICBmaWxlbmFtZTogJ2xvZ3Mvd2luc3Rvbi9taWQtZXJyb3JzLmxvZycsXHJcbiAgICAgICAgbWF4c2l6ZTogMzAwMDAwMDAsIC8vIDMwTUJcclxuICAgICAgICB0YWlsYWJsZTogdHJ1ZSxcclxuICAgICAgICBtYXhGaWxlczozXHJcbiAgICB9KVxyXG5dO1xyXG5jb25zdCBsb2dnZXJFcnJvciA9IGNyZWF0ZUxvZ2dlcih7XHJcbiAgICBmb3JtYXQ6IGZvcm1hdC5jb21iaW5lKFxyXG4gICAgICAgIGZvcm1hdC50aW1lc3RhbXAoeyBmb3JtYXQ6ICdZWVlZLU1NLUREVEhIOm1tOnNzOm1zJyB9KSxcclxuICAgICAgICBmb3JtYXQucHJpbnRmKGVyciA9PiB7IHJldHVybiBgJHtKU09OLnN0cmluZ2lmeShlcnIpfSxgOyB9KVxyXG4gICAgKSxcclxuICAgIHRyYW5zcG9ydHM6IHRyYW5zcG9ydEVycm9yc1xyXG59KTtcclxuXHJcbiAgIGV4cG9ydCBjb25zdCAgZXJyb3JNaWRMb2dnZXIgPSAoZXJyLCByZXEsIHJlcywgbmV4dCk9PntcclxuICAgICAgICBsb2dnZXJFcnJvci5lcnJvcihlcnIubWVzc2FnZSwge1xyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCksXHJcbiAgICAgICAgICAgIHN0YXR1c0NvZGU6IGVyci5zdGF0dXNDb2RlIHx8IFwiNTAwXCIsXHJcbiAgICAgICAgICAgIHVybDogcmVxLnVybCB8fCBcIlwiLFxyXG4gICAgICAgICAgICBzdGFjazogZXJyLnN0YWNrXHJcbiAgICAgICAgfSk7ICAgIFxyXG4gICAgICAgIHJlcy5zdGF0dXMoZXJyLnN0YXR1c0NvZGUgfHwgNTAwKS5zZW5kKGVyci5tZXNzYWdlIHx8IGVycik7XHJcbiAgICAgICAgbmV4dCgpO1xyXG4gICAgfSIsImV4cG9ydCBjbGFzcyBIdHRwRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcbiAgICBzdGF0dXNDb2RlOiBhbnk7XHJcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBzdGF0dXNDb2RlKSB7XHJcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XHJcbiAgICAgICAgdGhpcy5zdGF0dXNDb2RlID0gc3RhdHVzQ29kZSB8fCA1MDA7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSxSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcclxuY29uc3Qgcm91dGVyID0gUm91dGVyKCk7XHJcblxyXG5yb3V0ZXIuZ2V0KCcvJywgIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHZpZXdNb2RlbCA9IHtcclxuICAgIHBhZ2U6IHtcclxuICAgICAgaGVhZGVyOiB7XHJcbiAgICAgICAgdGl0bGU6ICdoZWFkZXIgdGl0bGUnLFxyXG4gICAgICB9LFxyXG4gICAgICB0aXRsZTogJ3BhZ2UgdGl0bGUnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJ3BhZ2UgZGVzY3JpcHRpb24nLFxyXG4gICAgICBsaW5rczogW3tcclxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5nb29nbGUuaXQnLFxyXG4gICAgICAgIGxhYmVsOiAnZ29vZ2xlIGxpbmsnLFxyXG4gICAgICAgIHRhcmdldDogJ19ibGFuaycsXHJcbiAgICAgIH0sIHtcclxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5nb29nbGUuaXQ/cD0yJyxcclxuICAgICAgICBsYWJlbDogJ2dvb2dsZSBsaW5rMicsXHJcbiAgICAgICAgdGFyZ2V0OiAnX2JsYW5rJyxcclxuICAgICAgfV0sXHJcbiAgICB9LFxyXG4gIH07XHJcblxyXG4gIHJlcy5yZW5kZXIoJ2hvbWUnLCB2aWV3TW9kZWwpO1xyXG59KTtcclxuZXhwb3J0IHsgcm91dGVyIH07XHJcbiIsImltcG9ydCB7IHJvdXRlciBhcyB1c2Vyc1JvdXRlIH0gZnJvbSAnLi91c2Vycyc7XHJcbmltcG9ydCB7cm91dGVyIGFzIGhvbWVSb3V0ZX0gZnJvbSAnLi4vcm91dGVzL2hvbWUnO1xyXG5pbXBvcnQgeyBFeHByZXNzIH0gZnJvbSAnZXhwcmVzcyc7XHJcblxyXG5pbXBvcnQgIHsgZXJyb3JNaWRMb2dnZXIgfSBmcm9tICcuLi9taWRkbGV3YXJlL21pZEVycm9ycyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoYXBwOiBFeHByZXNzKSB7XHJcbiAgYXBwLnVzZSgnL2FwaS91c2VycycsIHVzZXJzUm91dGUpO1xyXG4gIGFwcC51c2UoJy8nLCBob21lUm91dGUpO1xyXG5cclxuICBhcHAudXNlKGVycm9yTWlkTG9nZ2VyKTtcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xyXG5pbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSxSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcclxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vY29yZS9sb2dnZXInO1xyXG5pbXBvcnQgIHsgQURNSU4sIEJBU0UgfSAgZnJvbSAnLi4vY29yZS9yb2xlcyc7XHJcbmltcG9ydCB7YXV0aGVudGljYXRpb24sIGF1dGhvcml6YXRpb24gfSBmcm9tICcuLi9taWRkbGV3YXJlL2F1dGhQcm92aWRlcic7XHJcbmltcG9ydCAge1VzZXJzU2VydmljZSBhcyB1c2Vyc1NlcnZpY2V9IGZyb20gJy4uL3NlcnZpY2VzL3VzZXJzU2VydmljZSc7XHJcbmltcG9ydCAgeyB2YWxpZGF0ZUNyZWF0ZVVzZXIsIHZhbGlkYXRlRWRpdFVzZXIgfSBmcm9tICcuLi9zdG9yZS92YWxpZGF0b3JzJztcclxuaW1wb3J0IHsgSHR0cEVycm9yfSBmcm9tICcuLi9tb2RlbHMvZXJyb3JzJztcclxuXHJcbmNvbnN0IHJvdXRlciA9IFJvdXRlcigpO1xyXG5cclxucm91dGVyLmdldCgnLycsIGF1dGhlbnRpY2F0aW9uKCksIGF1dGhvcml6YXRpb24oW0FETUlOLCBCQVNFXSksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIGxvZ2dlci5pbmZvKCdZb3UgZ2V0IGFsbCB1c2VycyEnKTtcclxuICBjb25zdCByZXN1bHQgPSBhd2FpdCB1c2Vyc1NlcnZpY2UuZ2V0VXNlcnMoKTtcclxuXHJcbiAgcmVzLnNlbmQocmVzdWx0KTtcclxufSk7XHJcbnJvdXRlci5nZXQoJy86aWQnLCBhdXRoZW50aWNhdGlvbigpLCBhdXRob3JpemF0aW9uKFtBRE1JTiwgQkFTRV0pLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICBjb25zdCByZXN1bHQgPSBhd2FpdCB1c2Vyc1NlcnZpY2UuZ2V0VXNlcihyZXEucGFyYW1zLmlkKTtcclxuXHJcbiAgaWYgKCFyZXN1bHQpIHt0aHJvdyBuZXcgSHR0cEVycm9yKCdUaGUgdXNlciBub3QgZm91bmQuJywgNDA0KTt9XHJcblxyXG4gIHJlcy5zZW5kKHJlc3VsdCk7XHJcbn0pO1xyXG5yb3V0ZXIucG9zdCgnLycsIGF1dGhlbnRpY2F0aW9uKCksIGF1dGhvcml6YXRpb24oW0FETUlOXSksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHsgZXJyb3IgfSA9IHZhbGlkYXRlQ3JlYXRlVXNlcihyZXEuYm9keSk7XHJcblxyXG4gIGlmIChlcnJvcikge3Rocm93IG5ldyBIdHRwRXJyb3IoZXJyb3IuZGV0YWlsc1swXS5tZXNzYWdlLCA0MDApO31cclxuXHJcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdXNlcnNTZXJ2aWNlLmNyZWF0ZVVzZXIocmVxLmJvZHkpO1xyXG5cclxuICByZXMuc2VuZChyZXN1bHQpO1xyXG59KTtcclxucm91dGVyLnB1dCgnLzppZCcsIGF1dGhlbnRpY2F0aW9uKCksIGF1dGhvcml6YXRpb24oW0FETUlOXSksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHsgZXJyb3IgfSA9IHZhbGlkYXRlRWRpdFVzZXIocmVxLmJvZHkpO1xyXG5sZXQgdXNlclxyXG4gIGlmIChlcnJvcikge3Rocm93IG5ldyBIdHRwRXJyb3IoZXJyb3IuZGV0YWlsc1swXS5tZXNzYWdlLCA0MDApO31cclxuXHJcbiAgaWYgKHJlcS5ib2R5Ll9pZCAhPT0gcmVxLnBhcmFtcy5pZCkge3Rocm93IG5ldyBIdHRwRXJyb3IoJ1RoZSBib2R5IF9pZCBkb2VzIG5vdCBtYXRjaCB3aXRoIFVSTCBJRCcsIDQwMCk7fVxyXG5cclxuICBjb25zdCByZXN1bHQgPSBhd2FpdCB1c2Vyc1NlcnZpY2UuZ2V0VXNlcihyZXEucGFyYW1zLmlkKTtcclxuXHJcbiAgaWYgKCFyZXN1bHQpIHt0aHJvdyBuZXcgSHR0cEVycm9yKCdUaGUgdXNlciBub3QgZm91bmQuJywgNDA0KTt9XHJcblxyXG5cclxuICBjb25zdCByZXNwb25zZVVwZGF0ZSA9IGF3YWl0IHVzZXJzU2VydmljZS51cGRhdGVVc2VyKHJlcS5wYXJhbXMuaWQsIHJlcS5ib2R5KTtcclxuICBpZiAocmVzcG9uc2VVcGRhdGUub2spIHt1c2VyID0gYXdhaXQgdXNlcnNTZXJ2aWNlLmdldFVzZXIocmVxLnBhcmFtcy5pZCk7fVxyXG4gIHJlcy5zZW5kKHVzZXIpO1xyXG59KTtcclxucm91dGVyLmRlbGV0ZSgnLzppZCcsIGF1dGhlbnRpY2F0aW9uKCksIGF1dGhvcml6YXRpb24oW0FETUlOXSksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCB1c2Vyc1NlcnZpY2UuZ2V0VXNlcihyZXEucGFyYW1zLmlkKTtcclxuXHJcbiAgaWYgKCF1c2VyKSB7dGhyb3cgbmV3IEh0dHBFcnJvcignVGhlIHVzZXIgbm90IGZvdW5kLicsIDQwNCk7fVxyXG5cclxuICBjb25zdCByZXNwb25zZURlbGV0ZSA9IGF3YWl0IHVzZXJzU2VydmljZS5kZWxldGVVc2VyKHJlcS5wYXJhbXMuaWQpO1xyXG4gIHJlcy5zZW5kKHJlc3BvbnNlRGVsZXRlKTtcclxufSk7XHJcblxyXG5leHBvcnQgeyByb3V0ZXIgfTtcclxuIiwiXHJcbmltcG9ydCAgKiBhcyBkYkNvbnRleHQgZnJvbSBcIi4uL3N0b3JlL2RiQ29udGV4dFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFVzZXJzU2VydmljZSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkgeyB9XHJcbiAgc3RhdGljIGFzeW5jICBnZXRVc2VycygpIHtcclxuICAgIHJldHVybiBhd2FpdCBkYkNvbnRleHQuVXNlci5maW5kKClcclxuICAgICAgLy8gLmZpbmQoeyBwcmljZTogeyAkZ3RlOiAxMCB9IH0pXHJcbiAgICAgIC8vIC5maW5kKHsgcHJpY2U6IHsgJGluOiBbMTAsIDE1LCAyMF0gfSB9KVxyXG4gICAgICAvLyAub3IoWyB7IHByaWNlOiB7ICRpbjogWzEwLCAxNSwgMjBdIH0gfSwgeyBwcmljZTogbnVsbCB9IF0pXHJcbiAgICAgIC8vIC5hbmQoWyB7IHByaWNlOiB7ICRpbjogWzEwLCAxNSwgMjBdIH0gfSwgeyBwcmljZTogbnVsbCB9IF0pXHJcbiAgICAgIC8vIC5maW5kKClcclxuICAgICAgLy8gLnNvcnQoeyBuYW1lOiAxIH0pXHJcbiAgICAgIC8vLnNlbGVjdCh7IG5hbWU6IDEsIHRhZ3M6IDEgfSlcclxuICAgICAgLmxpbWl0KDEwKTtcclxuICB9O1xyXG4gIHN0YXRpYyBhc3luYyBnZXRVc2VyKGlkKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgZGJDb250ZXh0LlVzZXIuZmluZE9uZSh7IF9pZDogaWQgfSk7XHJcbiAgfTtcclxuICBzdGF0aWMgYXN5bmMgY3JlYXRlVXNlcih1c2VyKSB7XHJcbiAgICB1c2VyLmNyZWF0aW9uRGF0ZSA9IERhdGUubm93KCk7XHJcbiAgICBsZXQgX3VzZXIgPSBuZXcgZGJDb250ZXh0LlVzZXIodXNlcik7XHJcbiAgICByZXR1cm4gYXdhaXQgX3VzZXIuc2F2ZSgpO1xyXG4gIH07XHJcbiAgc3RhdGljIGFzeW5jIHVwZGF0ZVVzZXIoaWQsIHVzZXIpIHtcclxuICAgIHVzZXIubW9kaWZpY2F0aW9uRGF0ZSA9IERhdGUubm93KCk7XHJcbiAgICByZXR1cm4gYXdhaXQgZGJDb250ZXh0LlVzZXIudXBkYXRlT25lKHsgX2lkOiBpZCB9LCB1c2VyKTtcclxuICB9O1xyXG4gIHN0YXRpYyBhc3luYyBkZWxldGVVc2VyKGlkKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgZGJDb250ZXh0LlVzZXIuZGVsZXRlT25lKHsgX2lkOiBpZCB9KTtcclxuICB9O1xyXG59XHJcbiIsImltcG9ydCAqIGFzIG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xyXG5pbXBvcnQgKiBhcyBjb25maWcgZnJvbSAnY29uZmlnJztcclxuXHJcbmNvbnN0IGNvbm5lY3Rpb25TdHJpbmcgPSBjb25maWcuZ2V0KCdtb25nb2RiQ29ubmVjdGlvblN0cmluZycpIHx8IFwibW9uZ29kYjovL2xvY2FsaG9zdC9cIjtcclxuY29uc29sZS5sb2coY29ubmVjdGlvblN0cmluZyk7XHJcbmNvbnN0IGRiTmFtZSA9ICdBdXRoUHJvdmlkZXInO1xyXG5cclxuLy8gbW9uZ29vc2UuY29ubmVjdGlvbi5yZWFkeVN0YXRlOlxyXG4vLyAwOiBkaXNjb25uZWN0ZWRcclxuLy8gMTogY29ubmVjdGVkXHJcbi8vIDI6IGNvbm5lY3RpbmdcclxuXHJcbi8vIDM6IGRpc2Nvbm5lY3RpbmdcclxuY29uc3QgZGIgPSBtb25nb29zZS5jb25uZWN0aW9uO1xyXG5kYi5vbignY29ubmVjdGluZycsIGZ1bmN0aW9uICgpIHtcclxuICBjb25zb2xlLmxvZygnY29ubmVjdGluZyB0byBNb25nb0RCLi4uJyk7XHJcbn0pO1xyXG5kYi5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICBjb25zb2xlLmxvZygnRXJyb3IgaW4gTW9uZ29EYiBjb25uZWN0aW9uOiAnICsgZXJyb3IpO1xyXG59KTtcclxuZGIub24oJ2Nvbm5lY3RlZCcsIGZ1bmN0aW9uICgpIHtcclxuICBjb25zb2xlLmxvZygnTW9uZ29EQiBjb25uZWN0ZWQhJyk7XHJcbn0pO1xyXG5kYi5vbmNlKCdvcGVuJywgZnVuY3Rpb24gKCkge1xyXG4gIGNvbnNvbGUubG9nKCdNb25nb0RCIGNvbm5lY3Rpb24gb3BlbmVkIScpO1xyXG59KTtcclxuZGIub24oJ3JlY29ubmVjdGVkJywgZnVuY3Rpb24gKCkge1xyXG4gIGNvbnNvbGUubG9nKCdNb25nb0RCIHJlY29ubmVjdGVkIScpO1xyXG59KTtcclxuZGIub24oJ2Rpc2Nvbm5lY3RlZCcsIGZ1bmN0aW9uICgpIHtcclxuICBjb25zb2xlLmxvZygnTW9uZ29EQiBkaXNjb25uZWN0ZWQhJyk7XHJcbn0pO1xyXG5cclxubW9uZ29vc2UuY29ubmVjdChjb25uZWN0aW9uU3RyaW5nICsgZGJOYW1lLCB7XHJcbiAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlLFxyXG4gIHVzZU5ld1VybFBhcnNlcjogdHJ1ZVxyXG59KTtcclxuXHJcbi8vIHNjaGVtYXNcclxuY29uc3QgdXNlclNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xyXG4gIGZpcnN0TmFtZTogU3RyaW5nLFxyXG4gIGxhc3ROYW1lOiBTdHJpbmcsXHJcbiAgZW1haWw6IFN0cmluZyxcclxuICBpc0FjdGl2ZTogQm9vbGVhbixcclxuICBtb2RpZmljYXRpb25EYXRlOiB7IHR5cGU6IERhdGUsIGRlZmF1bHQ6IG51bGwgfSxcclxuICBjcmVhdGlvbkRhdGU6IHsgdHlwZTogRGF0ZSB9XHJcbn0pO1xyXG5leHBvcnQgY29uc3QgVXNlciA9IG1vbmdvb3NlLm1vZGVsKFwiVXNlclwiLCB1c2VyU2NoZW1hLCBcInVzZXJzXCIpO1xyXG4iLCIvLyBjb25zdCBKb2kgPSByZXF1aXJlKFwiam9pXCIpO1xyXG5pbXBvcnQgKiBhcyBKb2kgIGZyb20gJ2pvaSdcclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0ZUNyZWF0ZVVzZXIgPSAgKHVzZXIpPT4ge1xyXG4gICAgY29uc3QgdXNlclZhbGlkYXRvciA9IEpvaS5vYmplY3Qoe1xyXG4gICAgICAgIGZpcnN0TmFtZTogSm9pLnN0cmluZygpLm1pbigzKS5yZXF1aXJlZCgpLFxyXG4gICAgICAgIGxhc3ROYW1lOiBKb2kuc3RyaW5nKCkubWluKDMpLnJlcXVpcmVkKCksXHJcbiAgICAgICAgZW1haWw6IEpvaS5zdHJpbmcoKS5lbWFpbCh7IG1pbkRvbWFpblNlZ21lbnRzIDogMiB9KS5yZXF1aXJlZCgpLFxyXG4gICAgICAgIGlzQWN0aXZlOiBKb2kuYm9vbCgpXHJcbiAgICB9KTtcclxuICAgIHJldHVybiB1c2VyVmFsaWRhdG9yLnZhbGlkYXRlKHVzZXIpO1xyXG59XHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0ZUVkaXRVc2VyID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgIGNvbnN0IHVzZXJWYWxpZGF0b3IgPSBKb2kub2JqZWN0KHtcclxuICAgICAgICBfaWQ6IEpvaS5zdHJpbmcoKS5sZW5ndGgoMjQpLnJlcXVpcmVkKCksXHJcbiAgICAgICAgZmlyc3ROYW1lOiBKb2kuc3RyaW5nKCkubWluKDMpLnJlcXVpcmVkKCksXHJcbiAgICAgICAgbGFzdE5hbWU6IEpvaS5zdHJpbmcoKS5taW4oMykucmVxdWlyZWQoKSxcclxuICAgICAgICBlbWFpbDogSm9pLnN0cmluZygpLmVtYWlsKHsgbWluRG9tYWluU2VnbWVudHMgOiAyIH0pLnJlcXVpcmVkKCksXHJcbiAgICAgICAgaXNBY3RpdmU6IEpvaS5ib29sKClcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHVzZXJWYWxpZGF0b3IudmFsaWRhdGUodXNlcik7XHJcbn0iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjb25maWdcIik7OyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImV4cHJlc3NcIik7OyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImhlbG1ldFwiKTs7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiam9pXCIpOzsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7OyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpOzsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJtb3JnYW5cIik7OyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInBhdGhcIik7OyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIndpbnN0b25cIik7OyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIl0sInNvdXJjZVJvb3QiOiIifQ==