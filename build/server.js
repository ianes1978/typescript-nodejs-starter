!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=2)}([function(e,n){e.exports=require("express")},function(e,n){e.exports=require("config")},function(e,n,t){"use strict";n.__esModule=!0;var o=t(3),r=t(0),i=t(4),s=t(17),c=t(18),a=o.default.port||3e3,u=r();u.use(r.json()),u.use(r.urlencoded({extended:!0})),o.default.enableAccessLogs&&u.use(s("tiny")),u.use(c()),u.use(r.static("public")),i.default(u),u.listen(a,(function(){console.log("server started at http://localhost:"+a)}))},function(e,n,t){"use strict";n.__esModule=!0;var o=t(1),r={name:o.get("name"),mongodbConnectionString:o.get("mongodbConnectionString"),enableAccessLogs:o.get("enableAccessLogs"),port:o.get("port")};n.default=r},function(e,n,t){"use strict";n.__esModule=!0;var o=t(5),r=t(14);n.default=function(e){e.use("/api/users",o.router),e.use("/",r)}},function(e,n,t){"use strict";var o=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,c)}a((o=o.apply(e,n||[])).next())}))},r=this&&this.__generator||function(e,n){var t,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=n.call(e,s)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};n.__esModule=!0,n.router=void 0;var i=t(0).Router();n.router=i;var s=t(6).logger,c=t(8),a=c.ADMIN,u=c.BASE,l=t(9),f=t(10),d=t(13);i.get("/",l([a,u]),(function(e,n){return o(void 0,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return s.info("You get all users!"),[4,f.getUsers()];case 1:return e=t.sent(),n.send(e),[2]}}))}))})),i.get("/:id",l([a,u]),(function(e,n){return o(void 0,void 0,void 0,(function(){var t;return r(this,(function(o){switch(o.label){case 0:return[4,f.getUser(e.params.id)];case 1:if(!(t=o.sent()))throw new d("The user not found.",404);return n.send(t),[2]}}))}))}))},function(e,n,t){const{createLogger:o,transports:r,format:i}=t(7),s=[new r.File({level:"info",filename:"logs/winston/errors.log",maxsize:3e7,tailable:!0,maxFiles:3}),new r.Console({format:i.simple()})],c=[new r.File({level:"info",filename:"logs/winston/info.log",maxsize:3e7,tailable:!0,maxFiles:3}),new r.Console({format:i.simple()})],a=o({format:i.combine(i.printf(e=>e.message)),transports:s}),u=o({format:i.combine(i.printf(e=>e.message)),transports:c});e.exports={logger:{info(e){u.info(e+" | "+(new Date).toISOString())},error(e){a.error(e.message,{date:(new Date).toLocaleString(),statusCode:e.statusCode||"500",url:req.url||"",stack:e.stack})}}}},function(e,n){e.exports=require("winston")},function(e,n){e.exports={ADMIN:"ADMIN",BASE:"BASE"}},function(e,n){e.exports=function(e){return function(n,t,o){console.log("Authenticating...",e),o()}}},function(e,n,t){const o=t(11);e.exports=new class{constructor(){}async getUsers(){return await o.User.find().limit(10)}async getUser(e){return await o.User.findOne({_id:e})}async createUser(e){e.creationDate=Date.now();let n=new o.User(e);return await n.save()}async updateUser(e,n){return n.modificationDate=Date.now(),await o.User.updateOne({_id:e},n)}async deleteUser(e){return await o.User.deleteOne({_id:e})}}},function(e,n,t){const o=t(12),r=t(1).mongodbConnectionString||"mongodb://localhost/";console.log(r);db=o.connection,db.on("connecting",(function(){console.log("connecting to MongoDB...")})),db.on("error",(function(e){console.log("Error in MongoDb connection: "+e)})),db.on("connected",(function(){console.log("MongoDB connected!")})),db.once("open",(function(){console.log("MongoDB connection opened!")})),db.on("reconnected",(function(){console.log("MongoDB reconnected!")})),db.on("disconnected",(function(){console.log("MongoDB disconnected!")})),o.connect(r+"AuthProvider",{reconnectTries:Number.MAX_VALUE,reconnectInterval:5e3,useNewUrlParser:!0});const i=new o.Schema({firstName:String,lastName:String,email:String,isActive:Boolean,modificationDate:{type:Date,default:null},creationDate:{type:Date}}),s=o.model("User",i,"users");e.exports={User:s}},function(e,n){e.exports=require("mongoose")},function(e,n){e.exports=class extends Error{constructor(e,n){super(e),this.statusCode=n||500}}},function(e,n,t){const o=t(0);var r=t(15);const i=o.Router();var s=t(16);i.get("/",(e,n)=>{var t=r.readFileSync("./build/views/home.html","utf8"),o=s.to_html(t,{pagePosTitle:"titolo posizionamento",pageTitle:"titolo pagina",pageDescription:"titolo desrizione",link:{url:"https://www.google.it/",label:"link a google",target:"_blank"}});n.send(o)}),e.exports=i},function(e,n){e.exports=require("fs")},function(e,n){e.exports=require("mustache")},function(e,n){e.exports=require("morgan")},function(e,n){e.exports=require("helmet")}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiZXhwcmVzc1wiIiwid2VicGFjazovLy9leHRlcm5hbCBcImNvbmZpZ1wiIiwid2VicGFjazovLy8uL3NyYy9zZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbmZpZy50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcm91dGVzL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9yb3V0ZXMvdXNlcnMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvcmUvbG9nZ2VyLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcIndpbnN0b25cIiIsIndlYnBhY2s6Ly8vLi9zcmMvY29yZS9yb2xlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbWlkZGxld2FyZS9hdXRoUHJvdmlkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NlcnZpY2VzL3VzZXJzU2VydmljZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3RvcmUvZGJDb250ZXh0LmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcIm1vbmdvb3NlXCIiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0b3JlL21vZGVscy9jb21tb24tbW9kZWxzLmpzIiwid2VicGFjazovLy8uL3NyYy9yb3V0ZXMvaG9tZS5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJmc1wiIiwid2VicGFjazovLy9leHRlcm5hbCBcIm11c3RhY2hlXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwibW9yZ2FuXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiaGVsbWV0XCIiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJyZXF1aXJlIiwiUE9SVCIsInBvcnQiLCJhcHAiLCJleHByZXNzIiwidXNlIiwianNvbiIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsImVuYWJsZUFjY2Vzc0xvZ3MiLCJtb3JnYW4iLCJoZWxtZXQiLCJzdGF0aWMiLCJsaXN0ZW4iLCJjb25zb2xlIiwibG9nIiwiY29uZmlnIiwibm9kZUNvbmZpZyIsIm1vbmdvZGJDb25uZWN0aW9uU3RyaW5nIiwiaG9tZVJvdXRlIiwicm91dGVyIiwiUm91dGVyIiwibG9nZ2VyIiwiQURNSU4iLCJCQVNFIiwiYXV0aFByb3ZpZGVyIiwidXNlcnNTZXJ2aWNlIiwiSHR0cEVycm9yIiwicmVxIiwicmVzIiwiaW5mbyIsImdldFVzZXJzIiwicmVzdWx0Iiwic2VuZCIsImdldFVzZXIiLCJwYXJhbXMiLCJpZCIsImNyZWF0ZUxvZ2dlciIsInRyYW5zcG9ydHMiLCJmb3JtYXQiLCJ0cmFuc3BvcnRFcnJvciIsIkZpbGUiLCJsZXZlbCIsImZpbGVuYW1lIiwibWF4c2l6ZSIsInRhaWxhYmxlIiwibWF4RmlsZXMiLCJDb25zb2xlIiwic2ltcGxlIiwidHJhbnNwb3J0SW5mbyIsImxvZ2dlckVycm9yIiwiY29tYmluZSIsInByaW50ZiIsImVyciIsIm1lc3NhZ2UiLCJsb2dnZXJJbmZvIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZXJyb3IiLCJkYXRlIiwidG9Mb2NhbGVTdHJpbmciLCJzdGF0dXNDb2RlIiwidXJsIiwic3RhY2siLCJ2YWxpZFJvbGVzIiwibmV4dCIsImRiQ29udGV4dCIsIlVzZXIiLCJmaW5kIiwibGltaXQiLCJmaW5kT25lIiwiX2lkIiwidXNlciIsImNyZWF0aW9uRGF0ZSIsIm5vdyIsIl91c2VyIiwic2F2ZSIsIm1vZGlmaWNhdGlvbkRhdGUiLCJ1cGRhdGVPbmUiLCJkZWxldGVPbmUiLCJtb25nb29zZSIsImNvbm5lY3Rpb25TdHJpbmciLCJkYiIsImNvbm5lY3Rpb24iLCJvbiIsIm9uY2UiLCJjb25uZWN0IiwicmVjb25uZWN0VHJpZXMiLCJOdW1iZXIiLCJNQVhfVkFMVUUiLCJyZWNvbm5lY3RJbnRlcnZhbCIsInVzZU5ld1VybFBhcnNlciIsInVzZXJTY2hlbWEiLCJTY2hlbWEiLCJmaXJzdE5hbWUiLCJTdHJpbmciLCJsYXN0TmFtZSIsImVtYWlsIiwiaXNBY3RpdmUiLCJCb29sZWFuIiwidHlwZSIsImRlZmF1bHQiLCJtb2RlbCIsIkVycm9yIiwic3VwZXIiLCJ0aGlzIiwiZnMiLCJtdXN0YWNoZSIsInBhZ2UiLCJyZWFkRmlsZVN5bmMiLCJodG1sIiwidG9faHRtbCIsInBhZ2VQb3NUaXRsZSIsInBhZ2VUaXRsZSIsInBhZ2VEZXNjcmlwdGlvbiIsImxpbmsiLCJsYWJlbCIsInRhcmdldCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxv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TUFBT0YsT0FDUEcsU0FBVUMsUUFDVnRCLGlCQUFrQixDQUFFdUIsS0FBTTVDLEtBQU02QyxRQUFTLE1BQ3pDNUIsYUFBYyxDQUFFMkIsS0FBTTVDLFFBRWxCVyxFQUFPYSxFQUFTc0IsTUFBTSxPQUFRVixFQUFZLFNBRWhEN0gsRUFBT0QsUUFBVSxDQUNmcUcsUyxjQ2xERnBHLEVBQU9ELFFBQVVrQyxRQUFRLGEsY0NBekJqQyxFQUFPRCxRQUFVLGNBQXdCeUksTUFDckMsWUFBWWpELEVBQVNPLEdBQ2pCMkMsTUFBTWxELEdBQ05tRCxLQUFLNUMsV0FBWUEsR0FBYyxPLGdCQ0h2QyxNQUFNekQsRUFBVSxFQUFRLEdBQ3hCLElBQUlzRyxFQUFLLEVBQVEsSUFDakIsTUFBTXRGLEVBQVNoQixFQUFRaUIsU0FDdkIsSUFBSXNGLEVBQVcsRUFBUSxJQUV2QnZGLEVBQU92QyxJQUFJLElBQUssQ0FBQytDLEVBQUtDLEtBV3BCLElBQUkrRSxFQUFPRixFQUFHRyxhQUFhLDBCQUEyQixRQUNsREMsRUFBT0gsRUFBU0ksUUFBUUgsRUFYVixDQUNoQkksYUFBYyx3QkFDZEMsVUFBVyxnQkFDWEMsZ0JBQWlCLG9CQUNqQkMsS0FBTSxDQUNKckQsSUFBSyx5QkFDTHNELE1BQU8sZ0JBQ1BDLE9BQVEsWUFNWnhGLEVBQUlJLEtBQUs2RSxLQUVYL0ksRUFBT0QsUUFBVXNELEcsY0NyQmpCckQsRUFBT0QsUUFBVWtDLFFBQVEsTyxjQ0F6QmpDLEVBQU9ELFFBQVVrQyxRQUFRLGEsY0NBekJqQyxFQUFPRCxRQUFVa0MsUUFBUSxXLGNDQXpCakMsRUFBT0QsUUFBVWtDLFFBQVEiLCJmaWxlIjoic2VydmVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDIpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjb25maWdcIik7IiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuL2NvbmZpZyc7XHJcbmltcG9ydCAqIGFzIGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XHJcbmltcG9ydCByb3V0ZXMgZnJvbSAnLi9yb3V0ZXMvaW5kZXgnO1xyXG5pbXBvcnQgKiBhcyBtb3JnYW4gZnJvbSAnbW9yZ2FuJztcclxuaW1wb3J0ICogYXMgaGVsbWV0IGZyb20gJ2hlbG1ldCc7IC8vIFNlY3VyaXR5XHJcblxyXG5jb25zdCBQT1JUID0gY29uZmlnLnBvcnQgfHwgMzAwMDtcclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5cclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpO1xyXG5cclxuaWYgKGNvbmZpZy5lbmFibGVBY2Nlc3NMb2dzKSB7XHJcbiAgYXBwLnVzZShtb3JnYW4oJ3RpbnknKSk7XHJcbn1cclxuYXBwLnVzZShoZWxtZXQoKSk7XHJcblxyXG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKCdwdWJsaWMnKSk7XHJcblxyXG5yb3V0ZXMoYXBwKTtcclxuXHJcbmFwcC5saXN0ZW4oUE9SVCwgKCkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKCdzZXJ2ZXIgc3RhcnRlZCBhdCBodHRwOi8vbG9jYWxob3N0OicgKyBQT1JUKTtcclxufSk7XHJcbiIsImltcG9ydCAqIGFzIG5vZGVDb25maWcgZnJvbSAnY29uZmlnJztcclxuXHJcbmludGVyZmFjZSBDb25maWcge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBtb25nb2RiQ29ubmVjdGlvblN0cmluZzogc3RyaW5nO1xyXG4gIGVuYWJsZUFjY2Vzc0xvZ3M6IGJvb2xlYW47XHJcbiAgcG9ydDogbnVtYmVyO1xyXG59XHJcblxyXG5jb25zdCBjb25maWc6IENvbmZpZyA9IHtcclxuICBuYW1lOiBub2RlQ29uZmlnLmdldDxzdHJpbmc+KCduYW1lJyksXHJcbiAgbW9uZ29kYkNvbm5lY3Rpb25TdHJpbmc6IG5vZGVDb25maWcuZ2V0PHN0cmluZz4oJ21vbmdvZGJDb25uZWN0aW9uU3RyaW5nJyksXHJcbiAgZW5hYmxlQWNjZXNzTG9nczogbm9kZUNvbmZpZy5nZXQ8Ym9vbGVhbj4oJ2VuYWJsZUFjY2Vzc0xvZ3MnKSxcclxuICBwb3J0OiBub2RlQ29uZmlnLmdldDxudW1iZXI+KCdwb3J0JyksXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjb25maWc7XHJcbiIsImltcG9ydCB7IHJvdXRlciBhcyB1c2Vyc1JvdXRlIH0gZnJvbSAnLi91c2Vycyc7XHJcbmNvbnN0IGhvbWVSb3V0ZSA9IHJlcXVpcmUoJy4uL3JvdXRlcy9ob21lJyk7XHJcbmltcG9ydCB7IEV4cHJlc3MgfSBmcm9tICdleHByZXNzJztcclxuXHJcbi8vIGNvbnN0IHsgZXJyb3JNaWRMb2dnZXIgfSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvbWlkRXJyb3JzJyk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoYXBwOiBFeHByZXNzKSB7XHJcbiAgYXBwLnVzZSgnL2FwaS91c2VycycsIHVzZXJzUm91dGUpO1xyXG4gIGFwcC51c2UoJy8nLCBob21lUm91dGUpO1xyXG5cclxuICAvLyAgIGFwcC51c2UoZXJyb3JNaWRMb2dnZXIpO1xyXG59XHJcbiIsImltcG9ydCAqIGFzIGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XHJcbmltcG9ydCB7IFJvdXRlciB9IGZyb20gJ2V4cHJlc3MnO1xyXG5pbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnO1xyXG5jb25zdCByb3V0ZXIgPSBSb3V0ZXIoKTtcclxuXHJcbmNvbnN0IHsgbG9nZ2VyIH0gPSByZXF1aXJlKCcuLi9jb3JlL2xvZ2dlcicpO1xyXG5jb25zdCB7IEFETUlOLCBCQVNFIH0gPSByZXF1aXJlKCcuLi9jb3JlL3JvbGVzJyk7XHJcbmNvbnN0IGF1dGhQcm92aWRlciA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvYXV0aFByb3ZpZGVyJyk7XHJcbmNvbnN0IHVzZXJzU2VydmljZSA9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL3VzZXJzU2VydmljZScpO1xyXG4vLyBjb25zdCB7IHZhbGlkYXRlQ3JlYXRlVXNlciwgdmFsaWRhdGVFZGl0VXNlciB9ID0gcmVxdWlyZSgnLi4vc3RvcmUvdmFsaWRhdG9ycycpO1xyXG5jb25zdCBIdHRwRXJyb3IgPSByZXF1aXJlKCcuLi9zdG9yZS9tb2RlbHMvY29tbW9uLW1vZGVscycpO1xyXG5cclxucm91dGVyLmdldCgnLycsIGF1dGhQcm92aWRlcihbQURNSU4sIEJBU0VdKSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgbG9nZ2VyLmluZm8oJ1lvdSBnZXQgYWxsIHVzZXJzIScpO1xyXG4gIGxldCByZXN1bHQgPSBhd2FpdCB1c2Vyc1NlcnZpY2UuZ2V0VXNlcnMoKTtcclxuICByZXMuc2VuZChyZXN1bHQpO1xyXG59KTtcclxucm91dGVyLmdldCgnLzppZCcsIGF1dGhQcm92aWRlcihbQURNSU4sIEJBU0VdKSwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgbGV0IHJlc3VsdCA9IGF3YWl0IHVzZXJzU2VydmljZS5nZXRVc2VyKHJlcS5wYXJhbXMuaWQpO1xyXG4gIGlmICghcmVzdWx0KSB0aHJvdyBuZXcgSHR0cEVycm9yKCdUaGUgdXNlciBub3QgZm91bmQuJywgNDA0KTtcclxuXHJcbiAgcmVzLnNlbmQocmVzdWx0KTtcclxufSk7XHJcbi8vIHJvdXRlci5wb3N0KCcvJywgYXV0aFByb3ZpZGVyKFtBRE1JTl0pLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuLy8gICBjb25zdCB7IGVycm9yIH0gPSB2YWxpZGF0ZUNyZWF0ZVVzZXIocmVxLmJvZHkpO1xyXG4vLyAgIGlmIChlcnJvcikgdGhyb3cgbmV3IEh0dHBFcnJvcihlcnJvci5kZXRhaWxzWzBdLm1lc3NhZ2UsIDQwMCk7XHJcblxyXG4vLyAgIGxldCByZXN1bHQgPSBhd2FpdCB1c2Vyc1NlcnZpY2UuY3JlYXRlVXNlcihyZXEuYm9keSk7XHJcbi8vICAgcmVzLnNlbmQocmVzdWx0KTtcclxuLy8gfSk7XHJcbi8vIHJvdXRlci5wdXQoJy86aWQnLCBhdXRoUHJvdmlkZXIoW0FETUlOXSksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4vLyAgIGNvbnN0IHsgZXJyb3IgfSA9IHZhbGlkYXRlRWRpdFVzZXIocmVxLmJvZHkpO1xyXG4vLyAgIGlmIChlcnJvcikgdGhyb3cgbmV3IEh0dHBFcnJvcihlcnJvci5kZXRhaWxzWzBdLm1lc3NhZ2UsIDQwMCk7XHJcblxyXG4vLyAgIGlmIChyZXEuYm9keS5faWQgIT0gcmVxLnBhcmFtcy5pZCkgdGhyb3cgbmV3IEh0dHBFcnJvcignVGhlIGJvZHkgX2lkIGRvZXMgbm90IG1hdGNoIHdpdGggVVJMIElEJywgNDAwKTtcclxuXHJcbi8vICAgbGV0IHJlc3VsdCA9IGF3YWl0IHVzZXJzU2VydmljZS5nZXRVc2VyKHJlcS5wYXJhbXMuaWQpO1xyXG4vLyAgIGlmICghcmVzdWx0KSB0aHJvdyBuZXcgSHR0cEVycm9yKCdUaGUgdXNlciBub3QgZm91bmQuJywgNDA0KTtcclxuXHJcbi8vICAgcmVzdWx0ID0gYXdhaXQgdXNlcnNTZXJ2aWNlLnVwZGF0ZVVzZXIocmVxLnBhcmFtcy5pZCwgcmVxLmJvZHkpO1xyXG4vLyAgIGlmIChyZXN1bHQub2spIHJlc3VsdCA9IGF3YWl0IHVzZXJzU2VydmljZS5nZXRVc2VyKHJlcS5wYXJhbXMuaWQpO1xyXG4vLyAgIHJlcy5zZW5kKHJlc3VsdCk7XHJcbi8vIH0pO1xyXG4vLyByb3V0ZXIuZGVsZXRlKCcvOmlkJywgYXV0aFByb3ZpZGVyKFtBRE1JTl0pLCBhc3luYyAocmVxLCByZXMpID0+IHtcclxuLy8gICBsZXQgcmVzdWx0ID0gYXdhaXQgdXNlcnNTZXJ2aWNlLmdldFVzZXIocmVxLnBhcmFtcy5pZCk7XHJcbi8vICAgaWYgKCFyZXN1bHQpIHRocm93IG5ldyBIdHRwRXJyb3IoJ1RoZSB1c2VyIG5vdCBmb3VuZC4nLCA0MDQpO1xyXG5cclxuLy8gICByZXN1bHQgPSBhd2FpdCB1c2Vyc1NlcnZpY2UuZGVsZXRlVXNlcihyZXEucGFyYW1zLmlkKTtcclxuLy8gICByZXMuc2VuZChyZXN1bHQpO1xyXG4vLyB9KTtcclxuZXhwb3J0IHsgcm91dGVyIH07XHJcbiIsImNvbnN0IHsgY3JlYXRlTG9nZ2VyLCB0cmFuc3BvcnRzLCBmb3JtYXQgfSA9IHJlcXVpcmUoJ3dpbnN0b24nKTtcclxuXHJcbmNvbnN0IHRyYW5zcG9ydEVycm9yID0gW1xyXG4gICAgbmV3IHRyYW5zcG9ydHMuRmlsZSh7XHJcbiAgICAgICAgbGV2ZWw6ICdpbmZvJyxcclxuICAgICAgICBmaWxlbmFtZTogJ2xvZ3Mvd2luc3Rvbi9lcnJvcnMubG9nJyxcclxuICAgICAgICBtYXhzaXplOiAzMDAwMDAwMCwgLy8gMzBNQlxyXG4gICAgICAgIHRhaWxhYmxlOiB0cnVlLFxyXG4gICAgICAgIG1heEZpbGVzOjNcclxuICAgIH0pLFxyXG4gICAgbmV3IHRyYW5zcG9ydHMuQ29uc29sZSh7XHJcbiAgICAgICAgZm9ybWF0OiBmb3JtYXQuc2ltcGxlKClcclxuICAgIH0pXHJcbl07XHJcbmNvbnN0IHRyYW5zcG9ydEluZm8gPSBbXHJcbiAgICBuZXcgdHJhbnNwb3J0cy5GaWxlKHtcclxuICAgICAgICBsZXZlbDogJ2luZm8nLFxyXG4gICAgICAgIGZpbGVuYW1lOiAnbG9ncy93aW5zdG9uL2luZm8ubG9nJyxcclxuICAgICAgICBtYXhzaXplOiAzMDAwMDAwMCwgLy8gMzBNQlxyXG4gICAgICAgIHRhaWxhYmxlOiB0cnVlLFxyXG4gICAgICAgIG1heEZpbGVzOjNcclxuICAgIH0pLFxyXG4gICAgbmV3IHRyYW5zcG9ydHMuQ29uc29sZSh7XHJcbiAgICAgICAgZm9ybWF0OiBmb3JtYXQuc2ltcGxlKClcclxuICAgIH0pXHJcbl07XHJcbmNvbnN0IGxvZ2dlckVycm9yID0gY3JlYXRlTG9nZ2VyKHtcclxuICAgIGZvcm1hdDogZm9ybWF0LmNvbWJpbmUoXHJcbiAgICAgICAgZm9ybWF0LnByaW50ZihlcnIgPT4gZXJyLm1lc3NhZ2UpXHJcbiAgICApLFxyXG4gICAgdHJhbnNwb3J0czogdHJhbnNwb3J0RXJyb3JcclxufSk7XHJcbmNvbnN0IGxvZ2dlckluZm8gPSBjcmVhdGVMb2dnZXIoe1xyXG4gICAgZm9ybWF0OiBmb3JtYXQuY29tYmluZShcclxuICAgICAgICBmb3JtYXQucHJpbnRmKGluZm8gPT4gaW5mby5tZXNzYWdlKVxyXG4gICAgKSxcclxuICAgIHRyYW5zcG9ydHM6IHRyYW5zcG9ydEluZm9cclxufSk7XHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgbG9nZ2VyOiB7XHJcbiAgICAgICAgaW5mbyhtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlckluZm8uaW5mbyhtZXNzYWdlICsgXCIgfCBcIiArIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlcnJvcihlcnIpIHtcclxuICAgICAgICAgICAgbG9nZ2VyRXJyb3IuZXJyb3IoZXJyLm1lc3NhZ2UsIHtcclxuICAgICAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6IGVyci5zdGF0dXNDb2RlIHx8IFwiNTAwXCIsXHJcbiAgICAgICAgICAgICAgICB1cmw6IHJlcS51cmwgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgIHN0YWNrOiBlcnIuc3RhY2tcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwid2luc3RvblwiKTsiLCJjb25zdCByb2xlcyA9IHtcclxuICAgIEFETUlOOiBcIkFETUlOXCIsXHJcbiAgICBCQVNFOiBcIkJBU0VcIlxyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gcm9sZXM7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBhdXRoUHJvdmlkZXIodmFsaWRSb2xlcykge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGF1dGgocmVxLCByZXMsIG5leHQpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRoZW50aWNhdGluZy4uLicsIHZhbGlkUm9sZXMpO1xyXG4gICAgICAgIG5leHQoKTtcclxuICAgIH1cclxufTsiLCJcclxuY29uc3QgZGJDb250ZXh0ID0gcmVxdWlyZShcIi4uL3N0b3JlL2RiQ29udGV4dFwiKTtcclxuXHJcbmNsYXNzIFVzZXJzU2VydmljZSB7XHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuICBhc3luYyBnZXRVc2VycyAoKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgZGJDb250ZXh0LlVzZXIuZmluZCgpXHJcbiAgICAgIC8vIC5maW5kKHsgcHJpY2U6IHsgJGd0ZTogMTAgfSB9KVxyXG4gICAgICAvLyAuZmluZCh7IHByaWNlOiB7ICRpbjogWzEwLCAxNSwgMjBdIH0gfSlcclxuICAgICAgLy8gLm9yKFsgeyBwcmljZTogeyAkaW46IFsxMCwgMTUsIDIwXSB9IH0sIHsgcHJpY2U6IG51bGwgfSBdKVxyXG4gICAgICAvLyAuYW5kKFsgeyBwcmljZTogeyAkaW46IFsxMCwgMTUsIDIwXSB9IH0sIHsgcHJpY2U6IG51bGwgfSBdKVxyXG4gICAgICAvLyAuZmluZCgpXHJcbiAgICAgIC8vIC5zb3J0KHsgbmFtZTogMSB9KVxyXG4gICAgICAvLy5zZWxlY3QoeyBuYW1lOiAxLCB0YWdzOiAxIH0pXHJcbiAgICAgIC5saW1pdCgxMCk7XHJcbiAgfTtcclxuICBhc3luYyBnZXRVc2VyIChpZCkge1xyXG4gICAgcmV0dXJuIGF3YWl0IGRiQ29udGV4dC5Vc2VyLmZpbmRPbmUoeyBfaWQ6IGlkIH0pO1xyXG4gIH07XHJcbiAgYXN5bmMgY3JlYXRlVXNlciAodXNlcikge1xyXG4gICAgdXNlci5jcmVhdGlvbkRhdGUgPSBEYXRlLm5vdygpO1xyXG4gICAgbGV0IF91c2VyID0gbmV3IGRiQ29udGV4dC5Vc2VyKHVzZXIpO1xyXG4gICAgcmV0dXJuIGF3YWl0IF91c2VyLnNhdmUoKTtcclxuICB9O1xyXG4gIGFzeW5jIHVwZGF0ZVVzZXIgKGlkLCB1c2VyKSB7XHJcbiAgICB1c2VyLm1vZGlmaWNhdGlvbkRhdGUgPSBEYXRlLm5vdygpO1xyXG4gICAgcmV0dXJuIGF3YWl0IGRiQ29udGV4dC5Vc2VyLnVwZGF0ZU9uZSh7IF9pZDogaWQgfSwgdXNlcik7XHJcbiAgfTtcclxuICBhc3luYyBkZWxldGVVc2VyIChpZCkge1xyXG4gICAgcmV0dXJuIGF3YWl0IGRiQ29udGV4dC5Vc2VyLmRlbGV0ZU9uZSh7IF9pZDogaWQgfSk7XHJcbiAgfTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBVc2Vyc1NlcnZpY2UoKTtcclxuIiwiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKFwibW9uZ29vc2VcIik7XHJcbmNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoXCJjb25maWdcIik7XHJcblxyXG5jb25zdCBjb25uZWN0aW9uU3RyaW5nID0gY29uZmlnLm1vbmdvZGJDb25uZWN0aW9uU3RyaW5nIHx8IFwibW9uZ29kYjovL2xvY2FsaG9zdC9cIjtcclxuY29uc29sZS5sb2coY29ubmVjdGlvblN0cmluZyk7XHJcbmNvbnN0IGRiTmFtZSA9ICdBdXRoUHJvdmlkZXInO1xyXG5cclxuLy8gbW9uZ29vc2UuY29ubmVjdGlvbi5yZWFkeVN0YXRlOlxyXG4vLyAwOiBkaXNjb25uZWN0ZWRcclxuLy8gMTogY29ubmVjdGVkXHJcbi8vIDI6IGNvbm5lY3RpbmdcclxuLy8gMzogZGlzY29ubmVjdGluZ1xyXG5kYiA9IG1vbmdvb3NlLmNvbm5lY3Rpb247XHJcbmRiLm9uKCdjb25uZWN0aW5nJywgZnVuY3Rpb24oKSB7XHJcbiAgY29uc29sZS5sb2coJ2Nvbm5lY3RpbmcgdG8gTW9uZ29EQi4uLicpO1xyXG59KTtcclxuZGIub24oJ2Vycm9yJywgZnVuY3Rpb24oZXJyb3IpIHtcclxuICBjb25zb2xlLmxvZygnRXJyb3IgaW4gTW9uZ29EYiBjb25uZWN0aW9uOiAnICsgZXJyb3IpO1xyXG59KTtcclxuZGIub24oJ2Nvbm5lY3RlZCcsIGZ1bmN0aW9uKCkge1xyXG4gIGNvbnNvbGUubG9nKCdNb25nb0RCIGNvbm5lY3RlZCEnKTtcclxufSk7XHJcbmRiLm9uY2UoJ29wZW4nLCBmdW5jdGlvbigpIHtcclxuICBjb25zb2xlLmxvZygnTW9uZ29EQiBjb25uZWN0aW9uIG9wZW5lZCEnKTtcclxufSk7XHJcbmRiLm9uKCdyZWNvbm5lY3RlZCcsIGZ1bmN0aW9uICgpIHtcclxuICBjb25zb2xlLmxvZygnTW9uZ29EQiByZWNvbm5lY3RlZCEnKTtcclxufSk7XHJcbmRiLm9uKCdkaXNjb25uZWN0ZWQnLCBmdW5jdGlvbigpIHtcclxuICBjb25zb2xlLmxvZygnTW9uZ29EQiBkaXNjb25uZWN0ZWQhJyk7XHJcbn0pO1xyXG5cclxubW9uZ29vc2UuY29ubmVjdChjb25uZWN0aW9uU3RyaW5nICsgZGJOYW1lLCB7XHJcbiAgcmVjb25uZWN0VHJpZXM6IE51bWJlci5NQVhfVkFMVUUsIC8vIE5ldmVyIHN0b3AgdHJ5aW5nIHRvIHJlY29ubmVjdFxyXG4gIHJlY29ubmVjdEludGVydmFsOiA1MDAwLCAvLyBSZWNvbm5lY3QgZXZlcnkgNTAwMG1zXHJcbiAgdXNlTmV3VXJsUGFyc2VyOiB0cnVlXHJcbn0pO1xyXG5cclxuLy8gc2NoZW1hc1xyXG5jb25zdCB1c2VyU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XHJcbiAgZmlyc3ROYW1lOiBTdHJpbmcsXHJcbiAgbGFzdE5hbWU6IFN0cmluZyxcclxuICBlbWFpbDogU3RyaW5nLFxyXG4gIGlzQWN0aXZlOiBCb29sZWFuLFxyXG4gIG1vZGlmaWNhdGlvbkRhdGU6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogbnVsbCB9LFxyXG4gIGNyZWF0aW9uRGF0ZTogeyB0eXBlOiBEYXRlIH1cclxufSk7XHJcbmNvbnN0IFVzZXIgPSBtb25nb29zZS5tb2RlbChcIlVzZXJcIiwgdXNlclNjaGVtYSwgXCJ1c2Vyc1wiKTsgXHJcbi8vIG1vZGVsXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gIFVzZXJcclxufTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJtb25nb29zZVwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IGNsYXNzIEh0dHBFcnJvciBleHRlbmRzIEVycm9yIHtcclxuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIHN0YXR1c0NvZGUpIHtcclxuICAgICAgICBzdXBlcihtZXNzYWdlKTtcclxuICAgICAgICB0aGlzLnN0YXR1c0NvZGU9IHN0YXR1c0NvZGUgfHwgNTAwO1xyXG4gICAgfVxyXG59IiwiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxudmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxudmFyIG11c3RhY2hlID0gcmVxdWlyZSgnbXVzdGFjaGUnKTtcclxuXHJcbnJvdXRlci5nZXQoJy8nLCAocmVxLCByZXMpID0+IHtcclxuICBjb25zdCB2aWV3TW9kZWwgPSB7XHJcbiAgICBwYWdlUG9zVGl0bGU6ICd0aXRvbG8gcG9zaXppb25hbWVudG8nLFxyXG4gICAgcGFnZVRpdGxlOiAndGl0b2xvIHBhZ2luYScsXHJcbiAgICBwYWdlRGVzY3JpcHRpb246ICd0aXRvbG8gZGVzcml6aW9uZScsXHJcbiAgICBsaW5rOiB7XHJcbiAgICAgIHVybDogJ2h0dHBzOi8vd3d3Lmdvb2dsZS5pdC8nLFxyXG4gICAgICBsYWJlbDogJ2xpbmsgYSBnb29nbGUnLFxyXG4gICAgICB0YXJnZXQ6ICdfYmxhbmsnLFxyXG4gICAgfSxcclxuICB9O1xyXG4gIHZhciBwYWdlID0gZnMucmVhZEZpbGVTeW5jKCcuL2J1aWxkL3ZpZXdzL2hvbWUuaHRtbCcsICd1dGY4Jyk7XHJcbiAgdmFyIGh0bWwgPSBtdXN0YWNoZS50b19odG1sKHBhZ2UsIHZpZXdNb2RlbCk7XHJcblxyXG4gIHJlcy5zZW5kKGh0bWwpO1xyXG59KTtcclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImZzXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm11c3RhY2hlXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vcmdhblwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJoZWxtZXRcIik7Il0sInNvdXJjZVJvb3QiOiIifQ==